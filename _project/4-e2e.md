---
title: "多模态端到端的鲁棒泊车规划与控制"
excerpt: "停车场泊车场景中的多模态端到端鲁棒规划与控制<br/><img src='/images/figures/project/e2e/cover.png'>"
collection: project
---

## 项目简介

针对非结构化泊车场景中多模态感知感知融合、长时序任务场景鲁棒性差以及纯模仿学习存在分布偏移的问题，设计了一站式端到端自动驾驶解决方案E-RAMP。

- 深层多模态融合 (Perception): 提出 CCA (Channel-wise Cross-Attention) 机制，在特征通道维度上严格对齐 LiDAR 的几何信息与 Camera 的语义信息，解决传统融合的几何错位问题。
- 混合决策架构 (Control): 利用IL学习复杂的场景相关特征编码和基础策略。同时利用 IL 学习人类专家的行为先验，引入 RL 残差策略进行闭环动作修正，有效解决长时视界的累积误差。

大致流程如下：

<div style="text-align: center; margin-top: 20px;">
    <img src="/images/figures/project/e2e/pipeline.png" alt="E2E Pipeline" width="500" style="border-radius: 8px;">
</div>




## e2e模仿学习数据准备

e2e的模仿学习需要大量数据支撑，但是现有的数据集类似[nuplan](https://www.nuscenes.org/nuplan)，[nuscene](https://www.nuscenes.org/nuscenes)都是针对行车场景，为此我们再**CARLA**仿真平台设计了快速生成大量数据集的方法。

首先在仿真平台获取环境相关信息，再利用[环境评估的两阶段轨迹给规划方法](/project/2-parking)规划泊车轨迹，最后用横纵解耦的控制方法，横向何纵向都采用MPC控制器，控制跟踪规划泊车轨迹。我们配置了大量的传感器记录泊车过程相关数据用于后续训练。

<div style="display: flex; justify-content: center;">
    <video controls style="max-width: 100%; height: auto;">
        <source src="/images/figures/project/e2e/carla_results.mp4" type="video/webm">
    </video>
</div>

<div style="display: flex; justify-content: center;">
    <video controls style="max-width: 100%; height: auto;">
        <source src="/images/figures/project/e2e/carla_6in1.mp4" type="video/webm">
    </video>
</div>

## 闭环评估和强化学习环境设计

为了评估e2e模仿学习的base策略效果和残差强化学习的训练，我们在CARLA中的一个大型停车场环境中设计了闭环评估和强化学习环境。

- ego在停车场中随机初始化位置和朝向
- ego需要在停车场中自行探索并找到一个可行的泊车位进行泊车
- 环境中随机生成交互的车辆和路灯等静态障碍物

<div style="text-align: center; margin-top: 20px;">
    <img src="/images/figures/project/e2e/environment.png" alt="E2E Pipeline" width="500" style="border-radius: 8px;">
</div>

## 残差动作作用

残差动作在泊车的过程中对base策略进行修正，提升鲁棒性。下图展示了在一个泊车任务中，base策略和残差强化学习策略的动作对比，可以看到残差动作在关键时刻对base策略进行了有效的修正。

- Early Evasion(0-4s): 感知到远处大型truck类型障碍物，残差动作提前对base策略进行了提前转向规避修正
- Conservative Reversing(6-8s): 在倒车入库过程中，残差动作对base策略进行了转向修正，提升了泊车的稳定性
- Terminal Alignment(8-10s): 在最后对齐车位过程中，残差动作对base策略进行了微调，提升了最终的对齐精度


<div style="text-align: center; margin-top: 20px;">
    <img src="/images/figures/project/e2e/comparasion.png" alt="E2E Pipeline" width="700" style="border-radius: 8px;">
</div>

## 结果

更多闭环评估和强化学习训练结果请见下方视频：

<div style="display: flex; justify-content: center;">
    <video controls style="max-width: 100%; height: auto;">
        <source src="/images/figures/project/e2e/result.mp4" type="video/webm">
    </video>
</div>




